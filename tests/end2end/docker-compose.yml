version: "3"
services:
  backend:
    build:
      context: ../../backend
    depends_on:
      - json-caching-proxy
      - firestore-emulator
    environment:
      - DEBUG=1
      - PYTHONDEVMODE=1
      - FIRESTORE_EMULATOR_HOST=firestore-emulator:6001
      - YOUTUBE_API_KEY=AIzaSyDM-rEutI1Mr6_b1Uz8tofj2dDlwcOzkjs
      - YOUTUBE_API_URL=http://json-caching-proxy:8080/youtube/v3
      - LOGLEVEL=DEBUG
      - GOOGLE_CLOUD_PROJECT=videosdb-firebase

  frontend:
    environment:
      - FIRESTORE_EMULATOR_HOST=firestore-emulator:6001
    build:
      context: ../../frontend
    depends_on:
      - firestore-emulator

  json-caching-proxy:
    build:
      context: utils/json-caching-proxy
    ports:
      - 6001:6001

  firestore-emulator:
    build:
      context: utils/firestore-emulator
    volumes:
      - emulator-data:/root:rw
    ports:
      - 8080:8080

volumes:
  emulator-data:
