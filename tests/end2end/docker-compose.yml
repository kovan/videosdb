version: "3"
services:
  backend:
    build:
      context: ../../backend
    depends_on:
      - json-caching-proxy
      - firebase-emulator
    environment:
      - DEBUG=1
      - PYTHONDEVMODE=1
      - FIRESTORE_EMULATOR_HOST=firebase-emulator:6001
      - YOUTUBE_API_KEY=AIzaSyDM-rEutI1Mr6_b1Uz8tofj2dDlwcOzkjs
      - YOUTUBE_API_URL=http://json-caching-proxy:8080/youtube/v3
      - LOGLEVEL=DEBUG
      - GOOGLE_CLOUD_PROJECT=videosdb-firebase

  frontend:
    environment:
      - FIRESTORE_EMULATOR_HOST=firebase-emulator:6001
    build:
      context: ../../frontend
    depends_on:
      - firebase-emulator

  json-caching-proxy:
    build:
      context: utils/json-caching-proxy

  firebase-emulator:
    build:
      context: utils/firebase-emulator
    volumes:
      - emulator-data:/root/emulator-data:rw

volumes:
  emulator-data:
